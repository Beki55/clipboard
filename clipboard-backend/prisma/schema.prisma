datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        Int             @id @default(autoincrement())
  username  String          @unique
  email     String          @unique
  password  String
  devices   Device[]
  clipboard ClipboardItem[]
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt
}

model Device {
  // DEVICE ID MUST BE STRING NOW ✅
  id         String          @id
  userId     Int
  user       User            @relation(fields: [userId], references: [id])
  deviceName String?
  deviceType String?
  deviceOS   String?
  sessions   DeviceSession[]
  clipboard  ClipboardItem[]
  lastActive DateTime        @default(now())
}

model ClipboardItem {
  id          Int      @id @default(autoincrement())
  userId      Int
  deviceId    String?   // ✅ String
  content     String
  contentType String   @default("text")
  user        User     @relation(fields: [userId], references: [id])
  device      Device?  @relation(fields: [deviceId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model DeviceSession {
  id             Int      @id @default(autoincrement())
  deviceId       String   // ✅ String
  socketId       String
  connectedAt    DateTime @default(now())
  disconnectedAt DateTime?
  device         Device   @relation(fields: [deviceId], references: [id])
}
